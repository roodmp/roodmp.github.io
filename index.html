<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mark Rood - Resumé</title>
    <link rel="icon" type="image/x-icon" href="favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/geist@1.2.0/dist/fonts/geist-sans/style.min.css" rel="stylesheet">

    <!-- Design System -->
    <link rel="stylesheet" href="design-system.css">

    <!-- Main JS -->
    <script src="main.js"></script>

    <style>
        /* === RESUME PAGE STYLES === */

        /* Page Layout */
        .resume-container {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--space-8) var(--space-6);
        }

        /* Resume Header */
        .resume-header {
            margin-bottom: var(--space-10);
            padding-bottom: var(--space-6);
            border-bottom: 1px solid var(--surface-border);
        }

        .resume-name {
            font-size: var(--text-4xl);
            font-weight: 700;
            letter-spacing: -0.03em;
            margin-bottom: var(--space-2);
        }

        .resume-contact {
            color: var(--text-secondary);
            font-size: var(--text-base);
        }

        .resume-contact a {
            color: var(--accent-300);
            transition: color var(--transition-fast);
        }

        .resume-contact a:hover {
            color: var(--accent-200);
        }

        /* Sections */
        .resume-section {
            margin-bottom: var(--space-12);
        }

        .resume-section:last-child {
            margin-bottom: 0;
        }

        .section-heading {
            font-size: var(--text-2xl);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-3);
            border-bottom: 2px solid var(--accent-500);
            display: inline-block;
        }

        /* Summary */
        .summary-text {
            font-family: var(--font-serif);
            font-size: var(--text-lg);
            color: var(--text-secondary);
            line-height: 1.8;
        }

        /* Skills Grid */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: var(--space-5);
        }

        @media (min-width: 640px) {
            .skills-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .skills-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .skill-card {
            background: var(--surface-primary);
            border: 1px solid var(--surface-border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            transition: all var(--transition-normal);
        }

        .skill-card:hover {
            border-color: var(--surface-border-accent);
        }

        .skill-card-title {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--text-base);
            font-weight: 600;
            color: var(--accent-300);
            margin-bottom: var(--space-4);
        }

        .skill-card-title svg {
            width: 18px;
            height: 18px;
        }

        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-2);
        }

        .skill-tag {
            padding: var(--space-1) var(--space-3);
            background: var(--bg-elevated);
            color: var(--text-secondary);
            font-size: var(--text-xs);
            font-weight: 500;
            border-radius: var(--radius-full);
            transition: all var(--transition-fast);
        }

        .skill-tag:hover {
            background: var(--accent-500);
            color: white;
        }

        /* Work History */
        .job-entry {
            margin-bottom: var(--space-8);
            padding-bottom: var(--space-8);
            border-bottom: 1px solid var(--surface-border-subtle);
        }

        .job-entry:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .job-title-row {
            display: flex;
            flex-wrap: wrap;
            align-items: baseline;
            gap: var(--space-2);
            margin-bottom: var(--space-3);
        }

        .job-title {
            font-size: var(--text-xl);
            font-weight: 600;
            color: var(--text-primary);
        }

        .job-company {
            font-size: var(--text-lg);
            font-weight: 500;
            color: var(--accent-300);
        }

        .job-date {
            font-size: var(--text-sm);
            color: var(--text-tertiary);
            font-style: italic;
        }

        .job-description {
            color: var(--text-secondary);
            font-size: var(--text-sm);
            line-height: 1.7;
            margin-bottom: var(--space-2);
        }

        .job-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .job-list li {
            position: relative;
            padding-left: var(--space-5);
            margin-bottom: var(--space-2);
            color: var(--text-secondary);
            font-size: var(--text-sm);
            line-height: 1.7;
        }

        .job-list li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 10px;
            width: 6px;
            height: 6px;
            background: var(--accent-500);
            border-radius: 50%;
        }

        .job-list li:nth-child(even)::before {
            background: var(--panda-400);
        }

        /* Education & Recognition */
        .edu-entry,
        .recognition-entry {
            margin-bottom: var(--space-6);
        }

        .edu-title,
        .recognition-title {
            font-size: var(--text-lg);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-1);
        }

        .edu-institution,
        .recognition-date {
            font-size: var(--text-sm);
            color: var(--accent-300);
            margin-bottom: var(--space-2);
        }

        .recognition-desc {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Table of Contents */
        .toc {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            z-index: 40;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .toc::before {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 2px;
            height: 300px;
            background: transparent;
            border-radius: 0;
            opacity: 1;
            box-shadow:
                0 0 25px 10px rgba(74, 103, 133, 0.2),
                0 0 50px 20px rgba(74, 103, 133, 0.1),
                0 0 100px 30px rgba(74, 103, 133, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .toc:not(.expanded) {
            width: 20px;
            height: 400px;
            background: transparent;
            border: none;
            padding: 0;
            overflow: visible;
            cursor: pointer;
        }

        .toc:not(.expanded):hover::before {
            box-shadow:
                0 0 30px 12px rgba(74, 103, 133, 0.3),
                0 0 60px 25px rgba(74, 103, 133, 0.15),
                0 0 120px 35px rgba(74, 103, 133, 0.08);
        }

        .toc.expanded {
            width: 12rem;
            height: auto;
            background-color: rgba(38, 38, 36, 0.95);
            border: 1px solid var(--surface-border);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(16px);
            box-shadow: var(--shadow-lg);
            padding: var(--space-3);
            right: var(--space-8);
            cursor: default;
        }

        .toc.expanded::before {
            opacity: 0;
        }

        .toc-link {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            margin: var(--space-1) 0;
            border-radius: var(--radius-md);
            text-decoration: none;
            position: relative;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease 0.1s, visibility 0s 0.4s;
        }

        .toc.expanded .toc-link {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease 0.1s, visibility 0s 0s;
        }

        .toc-link:hover {
            background-color: var(--bg-hover);
        }

        .toc-link.active {
            background-color: rgba(74, 103, 133, 0.15);
        }

        .toc-link.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 2px;
            height: 16px;
            background: var(--accent-500);
            border-radius: 1px;
        }

        .toc-dot {
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background-color: var(--text-tertiary);
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .toc-link:hover .toc-dot {
            background-color: var(--accent-400);
            transform: scale(1.2);
        }

        .toc-link.active .toc-dot {
            background-color: var(--accent-400);
            transform: scale(1.4);
        }

        .toc-text {
            font-size: var(--text-sm);
            font-weight: 400;
            color: var(--text-secondary);
            transition: color 0.2s ease;
        }

        .toc-link:hover .toc-text {
            color: var(--text-primary);
        }

        .toc-link.active .toc-text {
            color: var(--accent-300);
            font-weight: 500;
        }

        @media (max-width: 1280px) {
            .toc {
                display: none;
            }
        }

        /* Footer */
        .resume-footer {
            margin-top: var(--space-16);
            padding-top: var(--space-8);
            border-top: 1px solid var(--surface-border-subtle);
            text-align: center;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: var(--space-4);
        }

        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            color: var(--text-tertiary);
            transition: all var(--transition-fast);
        }

        .social-link:hover {
            color: var(--text-primary);
            background: var(--bg-hover);
        }

        .social-link svg {
            width: 20px;
            height: 20px;
        }
    </style>
</head>

<body>
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Geometric Background -->
    <div class="geo-bg"></div>

    <!-- Table of Contents -->
    <nav class="toc" aria-label="Table of Contents" role="navigation">
        <a href="#summary" class="toc-link" data-section="summary">
            <div class="toc-dot"></div>
            <span class="toc-text">Summary</span>
        </a>
        <a href="#proficiencies" class="toc-link" data-section="proficiencies">
            <div class="toc-dot"></div>
            <span class="toc-text">Proficiencies</span>
        </a>
        <a href="#work-history" class="toc-link" data-section="work-history">
            <div class="toc-dot"></div>
            <span class="toc-text">Work History</span>
        </a>
        <a href="#education" class="toc-link" data-section="education">
            <div class="toc-dot"></div>
            <span class="toc-text">Education</span>
        </a>
        <a href="#recognitions" class="toc-link" data-section="recognitions">
            <div class="toc-dot"></div>
            <span class="toc-text">Recognitions</span>
        </a>
    </nav>

    <!-- Floating Navigation -->
    <header class="floating-header">
        <nav class="floating-nav">
            <a href="about.html" class="nav-logo">
                <img src="favicon.png" alt="Mark Rood" />
            </a>
            <div class="nav-links">
                <a href="about.html" class="nav-link">About</a>
                <a href="index.html" class="nav-link active">Resumé</a>
                <a href="resources.html" class="nav-link">Resources</a>
            </div>
        </nav>
    </header>

    <!-- Spacer for fixed nav -->
    <div style="height: 80px;"></div>

    <main id="main-content" class="section">
        <div class="resume-container">
            <!-- Resume Header -->
            <header class="resume-header">
                <h1 class="resume-name">Mark Rood</h1>
                <p class="resume-contact">
                    Colorado // <a href="mailto:Me@MarkRood.io">Me@MarkRood.io</a>
                </p>
            </header>

            <!-- Summary -->
            <section id="summary" class="resume-section">
                <h2 class="section-heading">Summary</h2>
                <p class="summary-text">
                    Product Manager building assistive and agentic AI features. 10+ years in IT and systems engineering gives me the technical depth to make product decisions that balance ambition with reality.
                </p>
            </section>

            <!-- Proficiencies -->
            <section id="proficiencies" class="resume-section">
                <h2 class="section-heading">Proficiencies</h2>

                <div class="skills-grid">
                    <!-- Development -->
                    <div class="skill-card">
                        <h3 class="skill-card-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
                            </svg>
                            Development
                        </h3>
                        <div class="skill-tags">
                            <span class="skill-tag">HTML / CSS / JS</span>
                            <span class="skill-tag">Git / GitHub</span>
                            <span class="skill-tag">PowerShell</span>
                            <span class="skill-tag">Microsoft SQL</span>
                            <span class="skill-tag">API</span>
                            <span class="skill-tag">Claude Code</span>
                            <span class="skill-tag">Vercel</span>
                        </div>
                    </div>

                    <!-- Management & Process -->
                    <div class="skill-card">
                        <h3 class="skill-card-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                            </svg>
                            Management & Process
                        </h3>
                        <div class="skill-tags">
                            <span class="skill-tag">Linear / Jira</span>
                            <span class="skill-tag">Project Management</span>
                            <span class="skill-tag">Technical Writing</span>
                            <span class="skill-tag">Zendesk Development</span>
                        </div>
                    </div>

                    <!-- Infrastructure & Security -->
                    <div class="skill-card">
                        <h3 class="skill-card-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                            </svg>
                            Infrastructure & Security
                        </h3>
                        <div class="skill-tags">
                            <span class="skill-tag">VMWare / Hyper-V</span>
                            <span class="skill-tag">Windows Svr 2012-2019</span>
                            <span class="skill-tag">MaaS360 / Intune</span>
                            <span class="skill-tag">Mimecast / Defender</span>
                            <span class="skill-tag">Endpoint Central / PDQ</span>
                            <span class="skill-tag">EXO / Exchange</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Work History -->
            <section id="work-history" class="resume-section">
                <h2 class="section-heading">Work History</h2>

                <!-- PDQ - Product Manager -->
                <div class="job-entry">
                    <div class="job-title-row">
                        <span class="job-title">Product Manager</span>
                        <span class="job-company">PDQ</span>
                    </div>
                    <p class="job-date">10/2024 to Current</p>
                    <ul class="job-list">
                        <li>Own product development for the PDQ Package Library, a catalog of 3rd party applications used by IT teams to deploy and patch software efficiently.</li>
                        <li>Rapidly prototype AI features to figure out what works, easier to learn from something you can click through than a spec doc.</li>
                    </ul>
                </div>

                <!-- PDQ - Systems Engineer -->
                <div class="job-entry">
                    <div class="job-title-row">
                        <span class="job-title">Systems Engineer</span>
                        <span class="job-company">PDQ</span>
                    </div>
                    <p class="job-date">05/2023 to 9/2024</p>
                    <ul class="job-list">
                        <li>Managed help centers for five products, enhancing self-help resources and reducing support requests by 5%.</li>
                        <li>Developed custom utilities and tools for internal and public use</li>
                        <li>Led the redesign and rearchitecture of customer support forms, resulting in improved user experience and streamlined issue resolution</li>
                        <li>Developed and implemented a streamlined feedback system to accelerate product iteration cycles and enhance user experience</li>
                        <li>Created and maintained a product discovery and education platform</li>
                    </ul>
                </div>

                <!-- PDQ - Solutions Engineer -->
                <div class="job-entry">
                    <div class="job-title-row">
                        <span class="job-title">Solutions Engineer</span>
                        <span class="job-company">PDQ</span>
                    </div>
                    <p class="job-date">10/2022 to 05/2023</p>
                    <ul class="job-list">
                        <li>Assist customers with technical issues and inquiries via the Zendesk ticketing system</li>
                        <li>Collaborate with cross-functional internal teams and departments</li>
                        <li>Create and maintain product's technical documentation</li>
                    </ul>
                </div>

                <!-- Western Partitions -->
                <div class="job-entry">
                    <div class="job-title-row">
                        <span class="job-title">System Administrator</span>
                        <span class="job-company">Western Partitions, Inc</span>
                    </div>
                    <p class="job-date">06/2022 to 10/2022</p>
                    <ul class="job-list">
                        <li>Reconfigure/maintain patching and updating infrastructure</li>
                        <li>Maintain device security policies with EDR solution</li>
                        <li>Establish device source-of-truth in dynamic industry</li>
                        <li>Maintain MDM solution for Windows, macOS, iOS and Android</li>
                        <li>Establish documentation practices</li>
                    </ul>
                </div>

                <!-- Majoris Health Systems -->
                <div class="job-entry">
                    <div class="job-title-row">
                        <span class="job-title">System Administrator</span>
                        <span class="job-company">Majoris Health Systems</span>
                    </div>
                    <p class="job-date">10/2019 to 05/2022</p>
                    <ul class="job-list">
                        <li>Optimized system availability (averaging 99.95% uptime)</li>
                        <li>Migrated company to MS365</li>
                        <li>Implemented MFA throughout company</li>
                        <li>Conducted security awareness training and education for all company employees</li>
                        <li>Wrote and maintained training documentation reducing trouble tickets by 25%</li>
                        <li>Applied security hardening baselines and policies</li>
                        <li>Created and maintained company policies, standards and IT budget</li>
                        <li>Maintained and optimized Document Management System and SQL server</li>
                        <li>Created end-user guides and educational documentation</li>
                    </ul>
                </div>

                <!-- Bishop Creek Services -->
                <div class="job-entry">
                    <div class="job-title-row">
                        <span class="job-title">System Administrator</span>
                        <span class="job-company">Bishop Creek Services</span>
                    </div>
                    <p class="job-date">08/2016 to 10/2019</p>
                    <p class="job-description">
                        <em>Contract with Majoris Health Systems ended in October 2019 at which time I was hired as a full-time employee.</em>
                    </p>
                    <ul class="job-list">
                        <li>Maintained 2 client infrastructures (Cummins Goodman, PC and Majoris Health Systems)</li>
                        <li>Developed and implemented policies in compliance with HIPAA and ISO27001</li>
                        <li>Documented and maintained IT procedures of client's IT infrastructure and workflow</li>
                        <li>Investigate and resolve end user PC problems and application issues through ticketing system</li>
                        <li>Collaborated with the CFO to develop justifications and cost/benefit analysis for IT initiatives</li>
                        <li>Restructured existing Active Directory and GPOs</li>
                        <li>Automated all applicable repeatable tasks</li>
                        <li>Installed patches/upgrades to infrastructure</li>
                    </ul>
                </div>

                <!-- USMC -->
                <div class="job-entry">
                    <div class="job-title-row">
                        <span class="job-title">Assistant Data Chief</span>
                        <span class="job-company">United States Marine Corps</span>
                    </div>
                    <p class="job-date">07/2012 to 09/2016</p>
                    <ul class="job-list">
                        <li>Administered Windows Environment</li>
                        <li>Managed 5 junior administrators</li>
                        <li>Designed, implemented and maintained equipment configuration prototypes, including network hardware, software and servers</li>
                        <li>Operated and maintained Mobile Modular Command & Control (M2C2) system</li>
                        <li>Acted as Information Security Coordinator (coordinated to higher echelon units)</li>
                    </ul>
                </div>
            </section>

            <!-- Education -->
            <section id="education" class="resume-section">
                <h2 class="section-heading">Education</h2>

                <div class="edu-entry">
                    <h3 class="edu-title">Certificate of Completion</h3>
                    <p class="edu-institution">Marine Corps Communications-Electronics School | 2012</p>
                    <ul class="job-list">
                        <li>Coursework in network / system administration</li>
                        <li>Computer / server hardware and software installation and maintenance</li>
                        <li>Coursework in information technology and computer applications</li>
                    </ul>
                </div>
            </section>

            <!-- Recognitions -->
            <section id="recognitions" class="resume-section">
                <h2 class="section-heading">Recognitions</h2>

                <div class="recognition-entry">
                    <h3 class="recognition-title">Navy and Marine Corps Achievement Medal</h3>
                    <p class="recognition-date">1 April 2016</p>
                    <p class="recognition-desc">
                        Awarded in recognition of duty while maintaining the billet of Assistant Data Network Chief by providing users enhanced capabilities allowing the battalion to operate at maximum efficiency. Provided critical communications support to an amphibious landing exercise in support of Operation Inherent Resolve.
                    </p>
                </div>

                <div class="recognition-entry">
                    <h3 class="recognition-title">Navy and Marine Corps Achievement Medal</h3>
                    <p class="recognition-date">11 March 2014</p>
                    <p class="recognition-desc">
                        Awarded in recognition of technical proficiency while operating in a deployed environment. Supporting up to but not limited to 1,000+ users across two tactical networks. While also operating and maintaining a vehicle based transmission system, Mobile Modular Command Center (M2C2) in support of Operation Enduring Freedom.
                    </p>
                </div>
            </section>

            <!-- Footer -->
            <footer class="resume-footer">
                <div class="social-links">
                    <a href="https://github.com/roodmp" class="social-link" aria-label="GitHub">
                        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                        </svg>
                    </a>
                    <a href="https://www.linkedin.com/in/roodmp/" class="social-link" aria-label="LinkedIn">
                        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
                            <rect x="2" y="9" width="4" height="12"></rect>
                            <circle cx="4" cy="4" r="2"></circle>
                        </svg>
                    </a>
                </div>
            </footer>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('section[id]');
            const tocLinks = document.querySelectorAll('.toc-link');
            const toc = document.querySelector('.toc');
            let scrollTimeout = null;

            if (!sections.length || !tocLinks.length || !toc) {
                return;
            }

            // TOC toggle functionality
            function toggleTOC(e) {
                if (!toc.classList.contains('expanded') || e.target === toc) {
                    e.preventDefault();
                    e.stopPropagation();
                    toc.classList.toggle('expanded');
                }
            }

            // Close TOC when clicking outside
            function closeTOC(e) {
                if (toc.classList.contains('expanded') && !toc.contains(e.target)) {
                    toc.classList.remove('expanded');
                }
            }

            toc.addEventListener('click', toggleTOC);
            document.addEventListener('click', closeTOC);

            // Throttled scroll handler
            function throttledUpdateActiveSection() {
                if (scrollTimeout) return;
                scrollTimeout = setTimeout(() => {
                    updateActiveSection();
                    scrollTimeout = null;
                }, 16);
            }

            // Update active section
            function updateActiveSection() {
                let currentSection = null;
                const fromTop = window.scrollY + window.innerHeight / 3;

                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.offsetHeight;

                    if (fromTop >= sectionTop && fromTop <= sectionTop + sectionHeight) {
                        currentSection = section.getAttribute('id');
                    }
                });

                tocLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${currentSection}`) {
                        link.classList.add('active');
                    }
                });
            }

            // Smooth scroll to section
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href');
                    const targetSection = document.querySelector(targetId);

                    if (targetSection) {
                        targetSection.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            window.addEventListener('scroll', throttledUpdateActiveSection, { passive: true });
            updateActiveSection();
        });
    </script>
</body>

</html>
