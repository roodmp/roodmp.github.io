<!DOCTYPE html>
<html lang="en" class="light">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mark Rood - Resumé</title>
    <link rel="icon" type="image/x-icon" href="favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="main.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            light: '#3B82F6',
                            dark: '#60A5FA',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @media (max-width: 640px) {
            body {
                font-size: 14px;
            }
        }
    </style>
    <style type="text/tailwindcss">
        @layer components {
        .nav-link {
            @apply text-sm text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200;
        }
        }
    </style>
    <style>
        .toc {
            position: fixed;
            right: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 40;
            background-color: var(--toc-bg-color);
            padding: 0.5rem;
            border-radius: 999px;
            transition: all 0.3s ease;
            width: 2rem;
            backdrop-filter: blur(8px);
        }

        .toc:hover {
            width: auto;
            border-radius: 0.75rem;
            padding: 0.5rem 0.75rem;
        }

        .toc-link {
            position: relative;
            display: grid;
            grid-template-columns: 0fr 1rem;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            justify-content: end;
            padding: 0.25rem 0;
        }

        .toc:hover .toc-link {
            grid-template-columns: 1fr 0fr;
        }

        .toc-line {
            width: 0.75rem;
            height: 1px;
            background-color: var(--toc-line-color);
            transition: all 0.3s ease;
            justify-self: end;
        }

        .toc:hover .toc-line {
            opacity: 0;
            width: 0;
            transition: opacity 0.15s ease, width 0.3s ease;
        }

        .toc-text {
            font-size: 0.8rem;
            color: var(--toc-text-color);
            opacity: 0;
            visibility: hidden;
            transform: translateX(0.75rem);
            transition: transform 0.3s ease,
                opacity 0.15s ease,
                visibility 0s linear 0.15s;
            white-space: nowrap;
            text-align: left;
            overflow: hidden;
            width: 0;
        }

        .toc:hover .toc-text {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
            width: auto;
            padding-right: 0.25rem;
            transition: transform 0.3s ease,
                opacity 0.15s ease 0.1s,
                visibility 0s linear 0s;
        }

        .toc-link:hover .toc-text,
        .toc-link.active .toc-text {
            color: var(--toc-active-color);
        }

        .toc-link:hover .toc-line,
        .toc-link.active .toc-line {
            background-color: var(--toc-active-color);
        }

        /* Light theme colors */
        :root {
            --toc-bg-color: rgba(255, 255, 255, 0.8);
            --toc-line-color: rgba(107, 114, 128, 0.5);
            --toc-text-color: rgba(107, 114, 128, 0.8);
            --toc-active-color: rgba(59, 130, 246, 0.9);
        }

        /* Dark theme colors */
        .dark {
            --toc-bg-color: rgba(31, 41, 55, 0.8);
            --toc-line-color: rgba(156, 163, 175, 0.5);
            --toc-text-color: rgba(156, 163, 175, 0.8);
            --toc-active-color: rgba(96, 165, 250, 0.9);
        }

        .toc-marker {
            position: absolute;
            left: -8px;
            width: 4px;
            height: 20px;
            background-color: var(--toc-active-color);
            border-radius: 2px;
            transition: transform 0.3s ease;
            opacity: 0;
        }

        .toc:hover .toc-marker {
            opacity: 1;
        }

        @media (max-width: 1280px) {
            .toc {
                display: none;
            }
        }
    </style>


</head>

<body class="bg-gray-100 dark:bg-gray-900 transition-colors duration-300">
    <nav class="toc" aria-label="Table of Contents" role="navigation">
        <div class="toc-marker" id="toc-marker" aria-hidden="true"></div>
    <div class="flex flex-col">
        <a href="#summary" class="toc-link" data-section="summary" aria-label="Navigate to Summary section">
            <span class="toc-text">Summary</span>
            <div class="toc-line" aria-hidden="true"></div>
        </a>
        <a href="#proficiencies" class="toc-link" data-section="proficiencies" aria-label="Navigate to Proficiencies section">
            <span class="toc-text">Proficiencies</span>
            <div class="toc-line" aria-hidden="true"></div>
        </a>
        <a href="#work-history" class="toc-link" data-section="work-history" aria-label="Navigate to Work History section">
            <span class="toc-text">Work History</span>
            <div class="toc-line" aria-hidden="true"></div>
        </a>
        <a href="#education" class="toc-link" data-section="education" aria-label="Navigate to Education section">
            <span class="toc-text">Education</span>
            <div class="toc-line" aria-hidden="true"></div>
        </a>
        <a href="#recognitions" class="toc-link" data-section="recognitions" aria-label="Navigate to Recognitions section">
            <span class="toc-text">Recognitions</span>
            <div class="toc-line" aria-hidden="true"></div>
        </a>
    </div>
    </nav>
    <header class="fixed top-4 sm:top-6 left-0 right-0 z-10 px-2 sm:px-4" role="banner">
        <nav class="bg-white/90 dark:bg-gray-800 backdrop-blur-md rounded-full shadow-lg max-w-fit mx-auto" role="navigation" aria-label="Main navigation">
            <div class="flex items-center gap-3 sm:gap-4 px-3 sm:px-4 py-2">
                <!-- Logo -->
                <a href="about.html" class="flex-shrink-0" aria-label="Home - Mark Rood Portfolio">
                    <img src="favicon.png" alt="Mark Rood Logo" class="h-7 w-auto" />
                </a>

                <!-- Middle navigation links -->
                <div class="flex items-center gap-3 sm:gap-4">
                    <a href="about.html" class="nav-link" aria-label="About page">About</a>
                    <a href="index.html" class="nav-link" aria-current="page" aria-label="Resume page">Resumé</a>
                    <a href="resources.html" class="nav-link" aria-label="Resources page">Resources</a>
                </div>

                <!-- Simple theme toggle -->
                <button id="themeToggle" class="nav-link p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-200" aria-label="Toggle dark mode">
                    <span class="material-icons dark:hidden text-gray-600">dark_mode</span>
                    <span class="material-icons hidden dark:inline text-gray-300">light_mode</span>
                </button>
            </div>
        </nav>
    </header>

    <div class="h-24"></div>
    <section class="py-5 md:py-10">
        <div class="container mx-auto px-4">
            <p class="text-3xl font-bold sm:text-4xl text-sky-800 dark:text-sky-300">Mark Rood</p>
            <p class="mb-5 text-gray-600 dark:text-gray-400">
                Colorado // <a href="mailto:Me@MarkRood.io"
                    class="hover:text-primary-light dark:hover:text-primary-dark transition-colors duration-300">Me@MarkRood.io</a>
            </p>
            <section id="summary" class="mb-8">
                <h2 class="text-2xl sm:text-3xl mb-3 text-gray-600 dark:text-gray-300"><strong>Summary</strong></h2>
                <p class="mb-3 text-gray-600 dark:text-gray-400">
                    Results-driven IT professional with 10+ years in system administration and
                    engineering across private sector and U.S. Marine Corps. Proven track record of
                    implementing innovative solutions in high-pressure environments. Eager to leverage
                    diverse experience and passion for cutting-edge technology to drive your team's
                    IT infrastructure to new levels of efficiency and security.
                </p>
            </section>
            <section id="proficiencies" class="mb-12" data-aos="fade-up">
                <h2 class="text-2xl font-bold mb-8 text-gray-800 dark:text-gray-200 border-b-2 border-primary-light dark:border-primary-dark pb-2">
                    Proficiencies
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Development Technologies -->
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md hover:shadow-lg transition-all duration-300">
                        <h3 class="text-lg font-semibold mb-4 text-primary-light dark:text-primary-dark">
                            <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                            </svg>
                            Development
                        </h3>
                        <div class="flex flex-wrap gap-2">
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">HTML
                                / CSS / JS</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Git
                                / GitHub</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">PowerShell</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Microsoft
                                SQL</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">API</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Tailwind
                            </span>
                        </div>
                    </div>

                    <!-- Management & Process -->
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md hover:shadow-lg transition-all duration-300">
                        <h3 class="text-lg font-semibold mb-4 text-primary-light dark:text-primary-dark">
                            <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                            Management & Process
                        </h3>
                        <div class="flex flex-wrap gap-2">
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Linear
                                / Jira</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Project
                                Management</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Technical
                                Writing</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Zendesk
                                Development</span>
                        </div>
                    </div>

                    <!-- Infrastructure & Security -->
                    <div
                        class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md hover:shadow-lg transition-all duration-300">
                        <h3 class="text-lg font-semibold mb-4 text-primary-light dark:text-primary-dark">
                            <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                            </svg>
                            Infrastructure & Security
                        </h3>
                        <div class="flex flex-wrap gap-2">
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">VMWare
                                / Hyper-V</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Windows
                                Svr 2012-2019</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">MaaS360
                                / Intune</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Mimecast
                                / Defender</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">Endpoint
                                Central / PDQ</span>
                            <span
                                class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm text-gray-700 dark:text-gray-300 hover:bg-primary-light hover:text-white dark:hover:bg-primary-dark transition-colors duration-300">EXO
                                / Exchange</span>
                        </div>
                    </div>
                </div>
            </section>

            <section id="work-history" class="mb-8">
                <h2 class="text-2xl sm:text-3xl mb-2 text-gray-600 dark:text-gray-300"><strong>Work History</strong></h2>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>Product Manager</strong> | <strong>PDQ </strong> |
                <em>10/2024 to Current</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>Own product development for the PDQ Package Library, a catalog of 3rd party applications used by IT teams to deploy and patch software efficiently.</li>
                <li>Benchmarked competitors and maintained an internal comparison matrix to identify product gaps and opportunities.</li>

            </ul>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>Systems Engineer</strong> | <strong>PDQ </strong> |
                <em>05/2023 to 9/2024</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>Managed help centers for five products, enhancing self-help resources and reducing support requests
                    by 5%.</li>
                <li>Developed custom utilities and tools for internal and public use</li>
                <li>Led the redesign and rearchitecture of customer support forms, resulting in improved user experience
                    and streamlined issue resolution</li>
                <li>Developed and implemented a streamlined feedback system to accelerate product iteration cycles and
                    enhance user experience</li>
                <li>Created and maintained a product discovery and education platform</li>
            </ul>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>Solutions Engineer</strong> | <strong>PDQ </strong> |
                <em>10/2022 to 05/2023</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>Assist customers with technical issues and inquiries via the Zendesk ticketing system</li>
                <li>Collaborate with cross-functional internal teams and departments</li>
                <li>Create and maintain product's technical documentation</li>
            </ul>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>System Administrator</strong> |
                <strong>Western Partitions, Inc, </strong> |
                <em>06/2022 to 10/2022</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>Reconfigure/maintain patching and updating infrastructure</li>
                <li>Maintain device security policies with EDR solution</li>
                <li>Establish device source-of-truth in dynamic industry</li>
                <li>Maintain MDM solution for Windows, macOS, iOS and Android</li>
                <li>Establish documentation practices</li>
            </ul>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>System Administrator</strong> |
                <strong>Majoris Health Systems</strong> | <em>10/2019 to 05/2022</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>Optimized system availability (averaging 99.95% uptime)</li>
                <li>Migrated company to MS365</li>
                <li>Implemented MFA throughout company</li>
                <li>
                    Conducted security awareness training and education for all company
                    employees
                </li>
                <li>
                    Wrote and maintained training documentation reducing trouble tickets
                    by 25%
                </li>
                <li>Applied security hardening baselines and policies</li>
                <li>
                    Created and maintained company policies, standards and IT budget
                </li>
                <li>
                    Maintained and optimized Document Management System and SQL server
                </li>
                <li>Created end-user guides and educational documentation</li>
            </ul>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>System Administrator</strong> |
                <strong>Bishop Creek Services</strong> | <em>08/2016 to 10/2019</em>
            </p>
            <p class="text-gray-600 dark:text-gray-400 mb-2">
                <em>Contract with Majoris Health Systems ended in October 2019 at which
                    time I was hired as a full-time employee.</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>
                    Maintained 2 client infrastructures (Cummins Goodman, PC and Majoris
                    Health Systems)
                </li>
                <li>
                    Developed and implemented policies in compliance with HIPAA and
                    ISO27001
                </li>
                <li>
                    Documented and maintained IT procedures of client's IT
                    infrastructure and workflow
                </li>
                <li>
                    Investigate and resolve end user PC problems and application issues
                    through ticketing system
                </li>
                <li>
                    Collaborated with the CFO to develop justifications and cost/benefit
                    analysis for IT initiatives
                </li>
                <li>Restructured existing Active Directory and GPOs</li>
                <li>Automated all applicable repeatable tasks</li>
                <li>Installed patches/upgrades to infrastructure</li>
            </ul>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>Assistant Data Chief</strong> |
                <strong>United States Marine Corps</strong> |
                <em>07/2012 to 09/2016</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>Administered Windows Environment</li>
                <li>Managed 5 junior administrators</li>
                <li>
                    Designed, implemented and maintained equipment configuration
                    prototypes, including network hardware, software and servers
                </li>
                <li>
                    Operated and maintained Mobile Modular Command &amp; Control (M2C2)
                    system
                </li>
                <li>
                    Acted as Information Security Coordinator (coordinated to higher
                    echelon units)
                </li>
            </ul>
            </section>

            <section id="education" class="mb-8">
                <h2 class="text-2xl sm:text-3xl mb-2 text-gray-600 dark:text-gray-300">
                    <strong>Education</strong>
                </h2>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>Certificate of Completion</strong> |
                <strong>Marine Corps Communications-Electronics School</strong> |
                <em>2012</em>
            </p>
            <ul class="mb-4 text-gray-600 dark:text-gray-400 list-disc pl-5">
                <li>Coursework in network / system administration</li>
                <li>
                    Computer / server hardware and software installation and maintenance
                </li>
                <li>
                    Coursework in information technology and computer applications
                </li>
            </ul>
            </section>

            <section id="recognitions" class="mb-8">
                <h2 class="text-2xl sm:text-3xl mb-2 text-gray-600 dark:text-gray-300">
                    <strong>Recognitions</strong>
                </h2>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>Navy and Marine Corps Achievement Medal</strong> |
                <em>1 April 2016</em>
            </p>
            <p class="mb-4 text-gray-600 dark:text-gray-400">
                Awarded in recognition of duty while maintaining the billet of
                Assistant Data Network Chief by providing users enhanced capabilities
                allowing the battalion to operate at maximum efficiency. Provided
                critical communications support to an amphibious landing exercise in
                support of Operation Inherent Resolve.
            </p>
            <p class="text-xl mb-2 text-gray-600 dark:text-gray-300">
                <strong>Navy and Marine Corps Achievement Medal</strong> |
                <em>11 March 2014</em>
            </p>
            <p class="mb-4 text-gray-600 dark:text-gray-400">
                Awarded in recognition of technical proficiency while operating in a
                deployed environment. Supporting up to but not limited to 1,000+ users
                across two tactical networks. While also operating and maintaining a
                vehicle based transmission system, Mobile Modular Command Center
                (M2C2) in support of Operation Enduring Freedom.
            </p>
            </section>
        </div>
    </section>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('section[id]');
            const tocLinks = document.querySelectorAll('.toc-link');
            const marker = document.getElementById('toc-marker');
            let lastActiveLink = null;
            let scrollTimeout = null;

            // Check if TOC elements exist
            if (!sections.length || !tocLinks.length || !marker) {
                console.warn('TOC elements not found, skipping TOC functionality');
                return;
            }

            // Update marker position
            function updateMarker(link) {
                if (!link || !marker) return;
                try {
                    const rect = link.getBoundingClientRect();
                    const tocRect = link.closest('.toc').getBoundingClientRect();
                    const relativeTop = rect.top - tocRect.top;
                    marker.style.transform = `translateY(${relativeTop + (rect.height / 2) - (marker.offsetHeight / 2)}px)`;
                } catch (error) {
                    console.warn('Error updating TOC marker:', error);
                }
            }

            // Throttled scroll handler
            function throttledUpdateActiveSection() {
                if (scrollTimeout) return;
                scrollTimeout = setTimeout(() => {
                    updateActiveSection();
                    scrollTimeout = null;
                }, 16); // ~60fps
            }

            // Update active section
            function updateActiveSection() {
                let currentSection = null;
                const fromTop = window.scrollY + window.innerHeight / 3;

                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.offsetHeight;

                    if (fromTop >= sectionTop && fromTop <= sectionTop + sectionHeight) {
                        currentSection = section.getAttribute('id');
                    }
                });

                tocLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${currentSection}`) {
                        link.classList.add('active');
                        lastActiveLink = link;
                        updateMarker(link);
                    }
                });
            }

            // Smooth scroll to section
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href');
                    const targetSection = document.querySelector(targetId);

                    if (targetSection) {
                        targetSection.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // Update on scroll with throttling
            window.addEventListener('scroll', throttledUpdateActiveSection, { passive: true });

            // Handle resize events
            window.addEventListener('resize', () => {
                if (lastActiveLink) {
                    updateMarker(lastActiveLink);
                }
            }, { passive: true });

            // Initial update
            updateActiveSection();
        });
    </script>

</body>

</html>